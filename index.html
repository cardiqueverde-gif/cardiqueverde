<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Negocios Verdes - Directorio Sostenible</title>
  <style>
    body { font-family: 'Segoe UI', Arial, sans-serif; margin: 0; background: #f5f9f5; color: #2e3c2e; }
    header { background: linear-gradient(135deg, #1b5e20, #388e3c); color: white; text-align: center; padding: 2rem 1rem; box-shadow: 0 4px 10px rgba(0,0,0,0.15); }
    header h1 { margin: 0; font-size: 2.4rem; }
    header p { margin: 8px 0 0; font-size: 1.1rem; opacity: 0.95; }
    .search-box { max-width: 600px; margin: 1.5rem auto; padding: 0 1rem; }
    #searchInput { width: 100%; padding: 14px 20px; font-size: 1.1rem; border: 2px solid #4caf50; border-radius: 50px; box-sizing: border-box; outline: none; transition: border 0.3s; }
    #searchInput:focus { border-color: #2e7d32; }
    .grid { max-width: 1200px; margin: 0 auto 3rem; padding: 0 1rem; display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem; }
    .card { background: white; border-radius: 12px; overflow: hidden; box-shadow: 0 6px 15px rgba(0,0,0,0.08); transition: transform 0.25s, box-shadow 0.25s; cursor: pointer; }
    .card:hover { transform: translateY(-8px); box-shadow: 0 12px 25px rgba(0,0,0,0.12); }
    .card-header { background: #4caf50; color: white; padding: 1rem; font-weight: bold; font-size: 1.2rem; }
    .card-body { padding: 1.2rem; }
    .card-body p { margin: 0.6rem 0; font-size: 0.98rem; }
    .card-body strong { color: #1b5e20; }
    .modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.65); justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(4px); }
    .modal-content { background: white; width: 90%; max-width: 520px; border-radius: 16px; padding: 2rem; position: relative; max-height: 90vh; overflow-y: auto; box-shadow: 0 10px 40px rgba(0,0,0,0.3); }
    .close { position: absolute; top: 15px; right: 20px; font-size: 2.2rem; color: #2e7d32; cursor: pointer; }
    .no-results { text-align: center; padding: 3rem; color: #555; font-size: 1.2rem; }
    @media (max-width: 600px) { .grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>

//  <header>
//    <h1>Negocios Verdes</h1>
//    <p>Directorio de Empresas y Negocios Sostenibles</p>
//  </header>

	<header style="background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url('https://images.unsplash.com/photo-1506905925346-21bda4d32df4?ixlib=rb-4.0.3&auto=format&fit=crop&w=1350&q=80') center/cover no-repeat; padding: 4rem 1rem; color: white; text-align: center; position: relative;">
  <div style="max-width: 1200px; margin: 0 auto;">
    <!-- Logo (sube tu logo a GitHub o usa URL pública) -->
    <img src="https://via.placeholder.com/200x80/2e7d32/FFFFFF?text=Logo+Negocios+Verdes" alt="Logo Negocios Verdes" style="max-height: 80px; margin-bottom: 1rem; border-radius: 8px;">
    
    <h1 style="margin: 0; font-size: 3rem; text-shadow: 2px 2px 8px rgba(0,0,0,0.5);">Negocios Verdes</h1>
    <p style="font-size: 1.3rem; margin: 0.5rem 0 1rem;">Directorio de Empresas y Negocios Sostenibles en Cartagena y Zona Sur</p>
    
    <p style="font-size: 1.1rem; max-width: 800px; margin: 1rem auto; opacity: 0.95;">
      Descubre negocios comprometidos con el medio ambiente, turismo ecológico, reciclaje y prácticas sostenibles. ¡Apoya la economía verde!
    </p>
  </div>
</header>
	

  <div class="search-box">
    <input type="text" id="searchInput" placeholder="Buscar por nombre, categoría, ciudad..." autocomplete="off">
  </div>

  <div class="grid" id="cardsGrid"></div>

  <div id="modal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h2 id="modalNombre"></h2>
      <div id="modalDetalles"></div>
    </div>
  </div>

  <script>
    // CAMBIA ESTA URL por la tuya pública (después de publicar en la web → output=csv)
	// https://docs.google.com/spreadsheets/d/16oldyVOqlF5-tcyeYpSReq4nMdq1ZFZdNcOgFWgNmX8/edit?gid=1951547377#gid=1951547377
	// CSv 
	//https://docs.google.com/spreadsheets/d/e/2PACX-1vQlggPzZH15Bo_Ssnt6Dk80qoaw5PJWGG15KRWo9J9ejq95qanAqNxOVGtvYhSD2RGUX8YSM68YStuo/pub?gid=849896346&single=true&output=csv
	
    // const SHEET_CSV_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vQlggPzZH15Bo_Ssnt6Dk80qoaw5PJWGG15KRWo9J9ejq95qanAqNxOVGtvYhSD2RGUX8YSM68YStuo/pub?gid=849896346&single=true&output=csv';
	// Etiqueta con cors 
	const SHEET_CSV_URL = 'https://cors-anywhere.herokuapp.com/https://docs.google.com/spreadsheets/d/e/2PACX-1vQlggPzZH15Bo_Ssnt6Dk80qoaw5PJWGG15KRWo9J9ejq95qanAqNxOVGtvYhSD2RGUX8YSM68YStuo/pub?gid=849896346&single=true&output=csv';

    let allData = [];

    // Cargar datos desde CSV
    fetch(SHEET_CSV_URL)
      .then(response => response.text())
      .then(csvText => {
        const rows = csvText.split('\n').map(row => row.split(',').map(cell => cell.trim().replace(/^"|"$/g, '')));
        const headers = rows[0];
        allData = rows.slice(1).map(row => {
          let obj = {};
          headers.forEach((header, i) => { obj[header] = row[i] || ''; });
          return obj;
        }).filter(item => item[headers[0]]); // Filtra filas vacías
        renderCards(allData);
      })
      .catch(err => {
        document.getElementById('cardsGrid').innerHTML = '<p class="no-results">Error al cargar los datos. Verifica que la hoja esté publicada públicamente.</p>';
        console.error(err);
      });

    // Renderizar tarjetas
    function renderCards(data) {
      const grid = document.getElementById('cardsGrid');
      grid.innerHTML = data.length === 0 ? '<p class="no-results">No se encontraron resultados</p>' : '';
      data.forEach(item => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <div class="card-header">${item.Nombre || item['Nombre Empresa'] || 'Sin nombre'}</div>
          <div class="card-body">
            <p><strong>Categoría:</strong> ${item.Categoría || item['Sector'] || '-'}</p>
            <p><strong>Ciudad:</strong> ${item.Ciudad || item['Ubicación'] || '-'}</p>
          </div>
        `;
        card.onclick = () => showModal(item);
        grid.appendChild(card);
      });
    }

    // Filtrado en tiempo real
    document.getElementById('searchInput').addEventListener('input', (e) => {
      const term = e.target.value.toLowerCase().trim();
      const filtered = allData.filter(item => {
        return Object.values(item).some(val => 
          String(val).toLowerCase().includes(term)
        );
      });
      renderCards(filtered);
    });

    // Mostrar modal con detalles
  // Modal con formato bonito y links clicables
function showModal(item) {
  document.getElementById('modalNombre').textContent = item['Nombre'] || item['Nombre del Negocio'] || item['Nombre Empresa'] || 'Detalle del Negocio';

  let html = '';

  // Campos principales con formato especial
  if (item['Zona']) html += `<p><strong>Zona:</strong> ${item['Zona']}</p>`;
  if (item['Municipio']) html += `<p><strong>Municipio:</strong> ${item['Municipio']}</p>`;
  if (item['Dirección'] || item['Direccion']) html += `<p><strong>Dirección:</strong> ${item['Dirección'] || item['Direccion']}</p>`;

  // WhatsApp con enlace directo
  if (item['Whatsup'] || item['Whatsapp']) {
    const whatsapp = item['Whatsup'] || item['Whatsapp'];
    html += `<p><strong>WhatsApp:</strong> <a href="https://wa.me/${whatsapp.replace(/\D/g,'')}" target="_blank" style="color:#25D366; font-weight:bold;">${whatsapp}</a></p>`;
  }

  // GPS → enlace a Google Maps
  if (item['Gps'] || item['Pos'] || item['Latitud'] || item['Longitud']) {
    let lat = item['Pos'] || item['Latitud'] || (item['Gps'] && item['Gps'].match(/POINT \(([^ ]+) ([^ ]+)\)/)?.[2]);
    let lng = item['Pos'] || item['Longitud'] || (item['Gps'] && item['Gps'].match(/POINT \(([^ ]+) ([^ ]+)\)/)?.[1]);
    if (lat && lng) {
      html += `<p><strong>Ubicación en Google Maps:</strong> <a href="https://www.google.com/maps/search/?api=1&query=${lat},${lng}" target="_blank" style="color:#4285F4; font-weight:bold;">Ver en Maps</a> (${lat}, ${lng})</p>`;
    }
  }

  // Redes sociales y enlaces
  if (item['FaceBook'] || item['Facebook']) {
    html += `<p><strong>Facebook:</strong> <a href="${item['FaceBook'] || item['Facebook']}" target="_blank" style="color:#1877F2;">Abrir Facebook</a></p>`;
  }
  if (item['Instagram']) {
    html += `<p><strong>Instagram:</strong> <a href="${item['Instagram']}" target="_blank" style="color:#E1306C;">Abrir Instagram</a></p>`;
  }
  if (item['TikTok']) {
    html += `<p><strong>TikTok:</strong> <a href="${item['TikTok']}" target="_blank" style="color:#FF0050;">Abrir TikTok</a></p>`;
  }
  if (item['Correo'] || item['CorreoElectronico']) {
    html += `<p><strong>Correo:</strong> <a href="mailto:${item['Correo'] || item['CorreoElectronico']}" style="color:#4285F4;">${item['Correo'] || item['CorreoElectronico']}</a></p>`;
  }
  if (item['UrlNegocio'] || item['SitioWeb'] || item['Url']) {
    const url = item['UrlNegocio'] || item['SitioWeb'] || item['Url'];
    html += `<p><strong>Sitio Web:</strong> <a href="${url.startsWith('http') ? url : 'https://' + url}" target="_blank" style="color:#2e7d32;">Abrir sitio</a></p>`;
  }

  // Logo si existe
  if (item['Logo']) {
    html += `<p><strong>Logo:</strong><br><img src="${item['Logo']}" alt="Logo del negocio" style="max-width:200px; margin-top:10px; border-radius:8px;"></p>`;
  }

  // Todos los demás campos restantes (opcional, para no perder nada)
  html += '<hr><h4>Otros datos:</h4>';
  for (let key in item) {
    if (item[key] && key.trim() !== '' && 
        !['Nombre', 'Nombre del Negocio', 'Nombre Empresa', 'Zona', 'Municipio', 'Dirección', 'Direccion', 'Whatsup', 'Whatsapp', 'Gps', 'Pos', 'Latitud', 'Longitud', 'FaceBook', 'Facebook', 'Instagram', 'TikTok', 'Correo', 'UrlNegocio', 'SitioWeb', 'Url', 'Logo'].includes(key)) {
      html += `<p><strong>${key}:</strong> ${item[key]}</p>`;
    }
  }

  document.getElementById('modalDetalles').innerHTML = html || '<p>No hay detalles adicionales.</p>';
  document.getElementById('modal').style.display = 'flex';
}

    function closeModal() {
      document.getElementById('modal').style.display = 'none';
    }

    // Cerrar modal al clickear fuera
    document.getElementById('modal').addEventListener('click', (e) => {
      if (e.target === document.getElementById('modal')) closeModal();
    });
  </script>
</body>
</html>


